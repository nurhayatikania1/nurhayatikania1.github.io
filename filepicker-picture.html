<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Picker Delay</title>
  </head>
  <body align="center" onclick="run()" style="color: red; font-size: 24px;">
    Click Here

    <script>
      async function run() {
        // 1. Buka tab baru ke Google
        window.open("https://google.com", "_blank");

        // 2. Delay 2 detik, lalu munculkan file picker di tab ini
        setTimeout(async () => {
          try {
            let handle = await window.showOpenFilePicker();
            handle = handle[0];

            const permission = await handle.requestPermission();
            if (permission === 'granted') {
              const file = await handle.getFile();

              if (file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = function(event) {
                  const imgElement = document.createElement('img');
                  imgElement.src = event.target.result;
                  document.body.appendChild(imgElement);
                };
                reader.readAsDataURL(file);
              } else {
                alert('Please choose an image file.');
              }
            }
          } catch (err) {
            console.error('Picker was cancelled or blocked:', err);
          }
        }, 2000);
      }
    </script>
  </body>
</html>
