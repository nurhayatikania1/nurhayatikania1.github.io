<!DOCTYPE html>
<html>
<body>
<pre id="log"></pre>
<script>
const log = msg => document.getElementById("log").textContent += "\n" + msg;

function sendPayload(payload, description) {
    try {
        window.ReactNativeWebView.postMessage(payload);
        log(`Sent (${description}): ${payload.substring(0, 50)}...`);
    } catch (e) {
        log(`Error sending (${description}): ${e.message}`);
    }
}

try {
    if (window.ReactNativeWebView) {
        log("ReactNativeWebView handler detected (Android). Starting full stress test...");

        // Loop kirim payload setiap 50ms
        setInterval(() => {
            // 1. Malformed JSON
            sendPayload("{unclosed_json", "Malformed JSON");

            // 2. Large JSON (~1MB)
            const bigPayload = '{"data":"' + "A".repeat(1_000_000) + '"}';
            sendPayload(bigPayload, "Large JSON (~1MB)");

            // 3. Unicode flood
            const unicodeFlood = '{"data":"' + "\u200F".repeat(20000) + '"}';
            sendPayload(unicodeFlood, "Unicode flood");

            // 4. Random binary data (1000 bytes)
            const binaryData = String.fromCharCode(...Array(1000).fill(0xFF));
            sendPayload(binaryData, "Binary data");

            // 5. Injection-like payload
            const injectionPayload = '{"cmd":"open_url","url":"javascript:alert(1)"}';
            sendPayload(injectionPayload, "Command injection");
        }, 50);

    } else {
        log("ReactNativeWebView handler not available.");
    }
} catch (e) {
    log("JS Exception: " + e.message);
}
</script>
</body>
</html>
