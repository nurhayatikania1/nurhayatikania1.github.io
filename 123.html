<!DOCTYPE html>
<html>
<body>
<pre id="log"></pre>
<script>
const log = msg => document.getElementById("log").textContent += "\n" + msg;

try {
    // Payload 1: valid JSON dengan string panjang
    const longString = "a".repeat(3000);
    const validPayload = JSON.stringify({ type: "long", data: longString });

    // Payload 2: malformed JSON (tidak ditutup)
    const malformedPayload = "{unclosed_json:";

    if (window.webkit?.messageHandlers?.ReactNativeWebView) {
        log("iOS ReactNativeWebView detected.");

        // Kirim valid JSON
        window.webkit.messageHandlers.ReactNativeWebView.postMessage(validPayload);
        log("Sent VALID JSON payload with 3000 'a' characters.");

        // Kirim malformed JSON
        window.webkit.messageHandlers.ReactNativeWebView.postMessage(malformedPayload);
        log("Sent MALFORMED JSON payload.");

    } else if (window.ReactNativeWebView) {
        log("Android ReactNativeWebView detected.");

        // Kirim valid JSON
        window.ReactNativeWebView.postMessage(validPayload);
        log("Sent VALID JSON payload with 3000 'a' characters.");

        // Kirim malformed JSON
        window.ReactNativeWebView.postMessage(malformedPayload);
        log("Sent MALFORMED JSON payload.");

    } else {
        log("ReactNativeWebView handler not available.");
    }
} catch (e) {
    log("JS Exception: " + e.message);
}
</script>
</body>
</html>
